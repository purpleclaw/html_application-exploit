# Exploiting HTML apllications

this repo contains the nesscary files to succesfully explit an html application.
If a file is created with the extension of .hta instead of .html, Internet Explorer will automatically
interpret it as a HTML Application and offer the ability to execute it using the mshta.exe program.

# Leveraging the html application

Similar to an HTML page, a typical HTML Application includes html, body, and script tags followed
by JavaScript or VBScript code. However. since the HTML Application is executed outside the
browser we are free to use legacy and dangerous f ea tu res that are often blocked within the
browser.
In this example, we will leverage ActiveXObjects, 342 which can potentially (and dangerously) provide
access to underlying operating system commands. This can be achieved through the Windows
Script Host functionality or WScript 343 and in particular the Windows Script Host Shell object.

# Creating POC script

We can place this code in a file on our Kali machine (poc.hta) and serve it from the Apache web
server. Once a victim accesses this file using Internet Explorer
dialog is presented because the sandbox protection of Internet Explorer, also called
Protected Mode, 346 is enabled by default. The victim can select Allow to permit the action, which will
execute the JavaScript code and launch cmd.exe

While mshta.exe is executing, it keeps an additional window open behind our command prompt.
To avoid this, we can update our proof-of-concept to close this window with the â€¢ ctose(); object
method
# Delivering Payload

We will use msfvenom to turn our basic HTML Application into an attack, relying on the hta-psh
output format to create an HTA payload based on PowerShell
the complete reverseshell payload is generated and saved into the file evil.hta.

# About evil.hta script

The first argument, -nop, is shorthand for -NoProfile, instructs PowerShell not to load
the PowerShell user profile.

When PowerShell is started, it will, by default, load any existing user's profile scripts, which might
negatively impact the execution of our code.This option will avoid that potential issue.

Next, our script uses -w hidden (shorthand for -window5tyte 348 hidden) to avoid creating a
window on the user's desktop.

Finally, the extremely important -e flag (shortha nd for -EncodedCommand) allows us to supply a
Base64 encoded 349 PowerShell script directly as a command line argument.

# HTA in action
  
We will host this new HTA application on our Kali machine and launch a Netcat listener to test our
attack. Then we will emulate our victim by browsing to the malicious URL and accepting the two
security warnings. If everything goes according to plan, we should be able to catch a reverse shell

This attack vector allows us to compromise a Windows client through Internet Explorer without the
presence of a specific software vulnerability. Since the link to the HTML Application can be
delivered via email, we can even compromise NATd internal clients.
